<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PONG Ultra-Divertido (Visual Renovado)</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            background-color: #0d1117; 
            color: #ffffff;
            font-family: 'Press Start 2P', cursive, monospace;
            overflow: hidden; 
        }

        /* Importa a fonte do Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

        /* COR PRINCIPAL DO JOGO: CIANO NÉON (#00bcd4) */

        h1 {
            margin-bottom: 10px;
            color: #00bcd4; /* Ciano néon mais vibrante */
            text-shadow: 0 0 12px #00bcd4, 0 0 24px #00bcd4; /* Brilho maior */
        }

        #gameCanvas {
            border: 5px solid #00bcd4; /* Borda do canvas em néon */
            background-color: #000000;
            box-shadow: 0 0 25px rgba(0, 188, 212, 0.7); /* Sombra néon mais intensa */
        }

        /* Botão Principal JOGAR */
        #botao-principal-container {
            margin: 25px 0 15px 0; 
        }
        
        .botao-principal {
            padding: 15px 30px;
            font-size: 1.5em;
            font-weight: bold;
            color: #1a1a1a; 
            background-color: #ff9800; /* Laranja Néon (Cor da Bola/Ação) */
            border: 5px solid #ff7043; 
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.1s, transform 0.1s, box-shadow 0.1s;
            user-select: none; 
            box-shadow: 0 0 18px rgba(255, 152, 0, 0.9); 
            font-family: 'Press Start 2P', cursive, monospace;
        }

        .botao-principal:hover {
            background-color: #ffcc80;
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(255, 204, 128, 1);
        }
        .botao-principal:active {
            transform: scale(0.95);
        }

        /* Estilo para o botão VOLTAR */
        #menuBtn {
            padding: 10px 20px;
            font-size: 1.0em;
            font-weight: bold;
            color: #e0e0e0; 
            background-color: #3f51b5; 
            border: 3px solid #303f9f; 
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.1s, transform 0.1s;
            user-select: none; 
            box-shadow: 0 0 10px rgba(63, 81, 181, 0.5);
            font-family: 'Press Start 2P', cursive, monospace;
            margin-top: 15px; 
        }

        #menuBtn:hover {
            background-color: #7986cb;
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(121, 134, 203, 1);
        }
        
        /* Botões Direcionais (MAIORES E MAIS ESPAÇADOS) */
        #controles-direcionais {
            display: flex;
            gap: 40px; 
            margin-top: 25px; 
        }

        .botao-controle {
            padding: 20px 45px; 
            font-size: 1.8em; 
            font-weight: bold;
            color: #1a1a1a;
            background-color: #00bcd4; /* Ciano Néon (Cor da Raquete) */
            border: 4px solid #0097a7; 
            border-radius: 15px; 
            cursor: pointer;
            transition: background-color 0.1s, transform 0.1s, box-shadow 0.1s;
            user-select: none; 
            box-shadow: 0 0 18px rgba(0, 188, 212, 0.9); 
            font-family: 'Press Start 2P', cursive, monospace;
        }

        .botao-controle:hover {
            background-color: #4dd0e1;
            transform: scale(1.05);
            box-shadow: 0 0 25px rgba(77, 208, 225, 1);
        }
        .botao-controle:active {
            transform: scale(0.95);
        }

        #instrucoes {
            margin-top: 20px; 
            font-size: 0.9em; 
            color: #999;
            text-align: center;
        }

        /* Estilos para dispositivos móveis */
        @media (max-width: 800px) {
            #gameCanvas {
                width: 90vw;
                height: 60vw;
            }
            .botao-principal { padding: 12px 25px; font-size: 1.3em; }
            /* Ajuste para mobile */
            .botao-controle { padding: 15px 35px; font-size: 1.5em; } 
            #controles-direcionais { gap: 20px; margin-top: 15px; } /* Reduz o gap no mobile */
            #menuBtn { font-size: 0.9em; padding: 8px 15px; }
        }
        
        footer {
            text-align: center;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            padding-top: 10px;
        }
    </style>
</head>
<body>

    <h1>PONG</h1>
    
    <canvas id="gameCanvas" width="800" height="500"></canvas> 

    <div id="botao-principal-container">
        <button id="playBtn" class="botao-principal">JOGAR / REINICIAR</button>
    </div>

    <div id="controles-direcionais">
        <button id="upBtn" class="botao-controle">▲ Cima</button>
        <button id="downBtn" class="botao-controle">▼ Baixo</button>
    </div>

    <div id="instrucoes">
        Use os botões **CIMA** e **BAIXO** para controlar.
        <br>Pressione <span style="color: #ff9800;">ESPAÇO</span> ou **JOGAR** para iniciar!
    </div>

    <button id="menuBtn">Voltar ao Menu</button> 

    <script>
        // --- Setup do Canvas ---
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let W = canvas.width;
        let H = canvas.height;
        
        // --- Constantes do Jogo (serão inicializadas em resizeCanvas) ---
        let RACKET_W, RACKET_H, RACKET_SPEED, BALL_SIZE, INITIAL_BALL_SPEED, MAX_BALL_SPEED, CPU_SPEED_BASE;

        // --- Variáveis de Jogo ---
        let gameLoopId;
        const FPS = 60;
        let gameState = 'start'; // 'start', 'playing', 'gameover'
        let playerScore = 0;
        let cpuScore = 0;
        const MAX_SCORE = 5; 
        
        // Raquetes
        let playerY, cpuY;
        let playerMovement = 0; 
        
        // Bola
        let ballX, ballY, ballSpeedX, ballSpeedY;
        
        // Partículas
        const particles = [];

        // --- Redimensionamento e Inicialização de Constantes ---
        function resizeCanvas() {
            const ratio = 800 / 500; // Proporção base 800x500
            if (window.innerWidth < 900) { 
                W = window.innerWidth * 0.9;
                H = W / ratio; 
                canvas.width = W;
                canvas.height = H;
            } else {
                W = 800;
                H = 500;
                canvas.width = W;
                canvas.height = H;
            }
            // Ajustar as constantes do jogo com base no novo W e H
            RACKET_H = H * 0.15;
            RACKET_W = Math.min(W, H) * 0.0125; 
            BALL_SIZE = Math.min(W, H) * 0.02; 
            
            // Velocidades ajustadas pela proporção
            RACKET_SPEED = 6 * (H / 500); 
            CPU_SPEED_BASE = 3.5 * (H / 500);
            INITIAL_BALL_SPEED = 5 * (W / 800);
            MAX_BALL_SPEED = 15 * (W / 800);

            // Posição inicial das raquetes
            playerY = H / 2 - RACKET_H / 2;
            cpuY = H / 2 - RACKET_H / 2;
            
            resetBall(true);
            draw();
        }
        window.addEventListener('resize', resizeCanvas);
        

        // --- Efeitos Sonoros (ATUALIZADO COM URLs PÚBLICAS) ---
        // URLs de áudios licenciados sob Creative Commons ou domínio público para garantir o funcionamento.
        const audioHit = new Audio('https://cdn.jsdelivr.net/gh/lucas-coelho/sfx-pack/pingpong-hit.mp3'); 
        const audioScore = new Audio('https://cdn.jsdelivr.net/gh/lucas-coelho/sfx-pack/score-point.mp3'); 
        const audioWall = new Audio('https://cdn.jsdelivr.net/gh/lucas-coelho/sfx-pack/wall-hit.mp3'); 
        const audioGameOver = new Audio('https://cdn.jsdelivr.net/gh/lucas-coelho/sfx-pack/game-over.mp3'); 
        const audioStart = new Audio('https://cdn.jsdelivr.net/gh/lucas-coelho/sfx-pack/game-start.mp3'); 
        
        // Ajuste no volume para alguns efeitos (opcional)
        if (audioWall) audioWall.volume = 0.5;
        if (audioScore) audioScore.volume = 0.8;

        function playSound(audioElement) {
            if (audioElement) {
                // Tenta clonar o elemento para que múltiplas batidas rápidas funcionem
                const clone = audioElement.cloneNode();
                clone.currentTime = 0; 
                clone.play().catch(e => {
                     // Muitos navegadores bloqueiam o áudio antes da primeira interação do usuário.
                     // O erro é silenciosamente ignorado para não atrapalhar o jogo.
                });
            }
        }
        
        // --- Classe Partícula ---
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 4 + 2; 
                this.speedX = (Math.random() * 2 - 1) * 0.7; 
                this.speedY = (Math.random() * 2 - 1) * 0.7; 
                this.color = color;
                this.alpha = 1;
                this.life = Math.random() * 40 + 40; 
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.alpha -= 1 / this.life;
                this.size *= 0.93; 
            }
            draw() {
                ctx.save();
                ctx.globalAlpha = this.alpha;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size / 2, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.shadowBlur = 5; 
                ctx.shadowColor = this.color;
                ctx.fill();
                ctx.closePath();
                ctx.restore();
            }
        }

        function createParticles(x, y, count, color) {
            for (let i = 0; i < count; i++) {
                particles.push(new Particle(x, y, color));
            }
        }
        
        // --- Funções de Desenho ---
        
        function clearCanvas() {
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, W, H);
        }

        function drawRacket(x, y) {
            ctx.fillStyle = '#00bcd4'; /* CIANO NÉON */
            ctx.fillRect(x, y, RACKET_W, RACKET_H);
            
            ctx.strokeStyle = '#0097a7'; 
            ctx.lineWidth = 2 * (W / 800); 
            ctx.strokeRect(x, y, RACKET_W, RACKET_H);

            ctx.shadowBlur = 10; 
            ctx.shadowColor = '#00bcd4';
            ctx.fillRect(x, y, RACKET_W, RACKET_H); 
            ctx.shadowBlur = 0; 
        }

        function drawBall() {
            ctx.beginPath();
            ctx.arc(ballX, ballY, BALL_SIZE / 2, 0, Math.PI * 2);
            ctx.fillStyle = '#ff9800'; /* LARANJA NÉON */
            ctx.shadowBlur = 15; 
            ctx.shadowColor = '#ff9800';
            ctx.fill();
            ctx.closePath();
            ctx.shadowBlur = 0; 
        }

        function drawScoreAndNet() {
            ctx.strokeStyle = '#00bcd4'; /* CIANO NÉON */
            ctx.lineWidth = 4 * (W / 800); 
            ctx.setLineDash([15, 10]); 
            ctx.beginPath();
            ctx.moveTo(W / 2, 0);
            ctx.lineTo(W / 2, H);
            ctx.stroke();
            ctx.setLineDash([]); 

            ctx.fillStyle = '#e0e0e0';
            ctx.font = `${40 * (W / 800)}px 'Press Start 2P', monospace`;
            ctx.textAlign = 'center';
            ctx.fillText(playerScore, W / 4, 50 * (H / 500));
            ctx.fillText(cpuScore, W * 3 / 4, 50 * (H / 500));
        }

        function drawParticles() {
            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].update();
                particles[i].draw();
                if (particles[i].alpha <= 0 || particles[i].size <= 0.5) {
                    particles.splice(i, 1);
                }
            }
        }
        
        function draw() {
            clearCanvas();
            drawScoreAndNet();
            drawRacket(0, playerY);
            drawRacket(W - RACKET_W, cpuY); 
            drawBall();
            drawParticles();
            
            if (gameState === 'start') {
                drawStartScreen();
            } else if (gameState === 'gameover') {
                drawGameOverScreen();
            }
        }

        function drawStartScreen() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(0, 0, W, H);
            ctx.fillStyle = '#e0e0e0';
            ctx.font = `${40 * (W / 800)}px 'Press Start 2P', monospace`;
            ctx.textAlign = 'center';
            ctx.fillText("PONG", W / 2, H / 2 - 60 * (H / 500));
            ctx.font = `${20 * (W / 800)}px 'Press Start 2P', monospace`;
            ctx.fillText("Pressione ESPAÇO ou", W / 2, H / 2 + 10 * (H / 500));
            ctx.fillText("clique em JOGAR para iniciar!", W / 2, H / 2 + 50 * (H / 500));
        }

        function drawGameOverScreen() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillRect(0, 0, W, H);
            ctx.fillStyle = '#e0e0e0';
            ctx.font = `${40 * (W / 800)}px 'Press Start 2P', monospace`;
            ctx.textAlign = 'center';
            ctx.fillText("FIM DE JOGO!", W / 2, H / 2 - 60 * (H / 500));
            
            let winner = playerScore >= MAX_SCORE ? "JOGADOR VENCEU!" : "CPU VENCEU!";
            ctx.font = `${30 * (W / 800)}px 'Press Start 2P', monospace`;
            ctx.fillText(winner, W / 2, H / 2);
            
            ctx.font = `${20 * (W / 800)}px 'Press Start 2P', monospace`;
            ctx.fillText("Pressione ESPAÇO ou", W / 2, H / 2 + 70 * (H / 500));
            ctx.fillText("clique em JOGAR para reiniciar!", W / 2, H / 2 + 110 * (H / 500));
        }
        
        // --- Lógica de Movimento ---
        
        function movePlayer() {
            playerY += playerMovement * RACKET_SPEED;
            if (playerY < 0) playerY = 0;
            if (playerY > H - RACKET_H) playerY = H - RACKET_H;
        }

        function moveCPU() {
            const targetY = ballY - RACKET_H / 2;
            const diff = targetY - cpuY;
            
            // Dificuldade da CPU
            let cpuEfficiency = 0.6 + (playerScore / MAX_SCORE) * 0.3; 
            if (playerScore >= MAX_SCORE / 2 && playerScore > cpuScore) {
                cpuEfficiency += 0.1;
            }
            cpuEfficiency = Math.min(cpuEfficiency, 0.95);

            cpuY += diff * cpuEfficiency * (CPU_SPEED_BASE / 10);
            
            if (cpuY < 0) cpuY = 0;
            if (cpuY > H - RACKET_H) cpuY = H - RACKET_H;
        }

        function moveBall() {
            ballX += ballSpeedX;
            ballY += ballSpeedY;
            
            createParticles(ballX, ballY, 1, '#ff9800'); /* Partículas LARANJA */

            // Colisão com teto/chão
            if (ballY < BALL_SIZE / 2 || ballY > H - BALL_SIZE / 2) {
                ballSpeedY = -ballSpeedY;
                playSound(audioWall);
                if (ballY < BALL_SIZE / 2) ballY = BALL_SIZE / 2;
                if (ballY > H - BALL_SIZE / 2) ballY = H - BALL_SIZE / 2;
            }

            // Colisão com Raquete do Jogador (Esquerda)
            if (ballX - BALL_SIZE / 2 <= RACKET_W && 
                ballY > playerY && ballY < playerY + RACKET_H) 
            {
                ballSpeedX = -ballSpeedX;
                
                // Aumenta a velocidade
                let currentSpeed = Math.sqrt(ballSpeedX * ballSpeedX + ballSpeedY * ballSpeedY);
                if (currentSpeed < MAX_BALL_SPEED) {
                    ballSpeedX *= 1.05; 
                    ballSpeedY *= 1.05;
                }
                
                // Ajusta o ângulo
                const collidePoint = ballY - (playerY + RACKET_H / 2);
                ballSpeedY = (collidePoint / (RACKET_H / 2)) * (MAX_BALL_SPEED / 2);
                ballX = RACKET_W + BALL_SIZE / 2; 

                playSound(audioHit);
                createParticles(ballX - BALL_SIZE/2, ballY, 10, '#ffffff');
            }

            // Colisão com Raquete da CPU (Direita)
            if (ballX + BALL_SIZE / 2 >= W - RACKET_W && 
                ballY > cpuY && ballY < cpuY + RACKET_H) 
            {
                ballSpeedX = -ballSpeedX;
                
                // Aumenta a velocidade
                let currentSpeed = Math.sqrt(ballSpeedX * ballSpeedX + ballSpeedY * ballSpeedY);
                if (currentSpeed < MAX_BALL_SPEED) {
                    ballSpeedX *= 1.05; 
                    ballSpeedY *= 1.05;
                }

                const collidePoint = ballY - (cpuY + RACKET_H / 2);
                ballSpeedY = (collidePoint / (RACKET_H / 2)) * (MAX_BALL_SPEED / 2);
                
                ballX = W - RACKET_W - BALL_SIZE / 2; 

                playSound(audioHit);
                createParticles(ballX + BALL_SIZE/2, ballY, 10, '#ffffff');
            }
            
            // --- Marcar Ponto ---
            if (ballX < 0) {
                cpuScore++;
                playSound(audioScore);
                checkGameOver();
                resetBall();
            }

            if (ballX > W) {
                playerScore++;
                playSound(audioScore);
                checkGameOver();
                resetBall();
            }
        }
        
        // --- Lógica de Jogo ---
        
        function resetBall(initial = false) {
            ballX = W / 2;
            ballY = H / 2;
            
            if (initial) {
                ballSpeedX = 0;
                ballSpeedY = 0;
            } else {
                const dirX = Math.random() < 0.5 ? 1 : -1;
                
                ballSpeedX = INITIAL_BALL_SPEED * dirX; 
                ballSpeedY = (Math.random() * 4 - 2) * (H / 500); 
            }
        }
        
        function checkGameOver() {
            if (playerScore >= MAX_SCORE || cpuScore >= MAX_SCORE) {
                gameState = 'gameover';
                clearInterval(gameLoopId);
                playSound(audioGameOver);
            }
        }
        
        function gameLoop() {
            if (gameState === 'playing') {
                movePlayer();
                moveCPU();
                moveBall();
            }
            draw();
        }
        
        // --- Controle de Input ---

        // Teclado (Manter para desktop)
        document.addEventListener('keydown', (e) => {
            if (gameState === 'playing') {
                if (e.key === 'w' || e.key === 'W') {
                    playerMovement = -1; 
                } else if (e.key === 's' || e.key === 'S') {
                    playerMovement = 1; 
                }
            }
            if (e.key === ' ' && (gameState === 'start' || gameState === 'gameover')) {
                initGame();
            }
        });

        document.addEventListener('keyup', (e) => {
            if (gameState === 'playing') {
                if ((e.key === 'w' || e.key === 'W') && playerMovement === -1) {
                    playerMovement = 0; 
                } else if ((e.key === 's' || e.key === 'S') && playerMovement === 1) {
                    playerMovement = 0; 
                }
            }
        });

        // Botão JOGAR/REINICIAR
        const playBtn = document.getElementById('playBtn');
        
        function handleStartRestart() {
             if (gameState === 'start' || gameState === 'gameover') {
                initGame();
            }
        }
        
        playBtn.addEventListener('click', handleStartRestart);
        
        // Botão VOLTAR AO MENU
        const menuBtn = document.getElementById('menuBtn');
        menuBtn.addEventListener('click', () => {
            // Redireciona para o arquivo menu-minigames.html na mesma pasta
            window.location.href = 'menu-minigames.html'; 
        });

        // Botões Direcionais (Mobile/Mouse)
        const upBtn = document.getElementById('upBtn');
        const downBtn = document.getElementById('downBtn');

        function startMoving(direction) {
            if (gameState === 'playing') {
                playerMovement = direction;
            }
        }

        function stopMoving() {
            playerMovement = 0;
        }

        // Eventos para o botão "Cima"
        upBtn.addEventListener('mousedown', () => startMoving(-1));
        upBtn.addEventListener('mouseup', stopMoving);
        upBtn.addEventListener('mouseleave', stopMoving); 
        upBtn.addEventListener('touchstart', (e) => { e.preventDefault(); startMoving(-1); }); 
        upBtn.addEventListener('touchend', stopMoving);

        // Eventos para o botão "Baixo"
        downBtn.addEventListener('mousedown', () => startMoving(1));
        downBtn.addEventListener('mouseup', stopMoving);
        downBtn.addEventListener('mouseleave', stopMoving); 
        downBtn.addEventListener('touchstart', (e) => { e.preventDefault(); startMoving(1); }); 
        downBtn.addEventListener('touchend', stopMoving);
        
        // --- Inicialização do Jogo ---
        function initGame() {
            playerScore = 0;
            cpuScore = 0;
            
            // Recalcula posições iniciais
            playerY = H / 2 - RACKET_H / 2;
            cpuY = H / 2 - RACKET_H / 2;
            
            particles.length = 0; 
            resetBall();
            
            if (gameLoopId) clearInterval(gameLoopId);
            gameLoopId = setInterval(gameLoop, 1000 / FPS);
            
            gameState = 'playing'; 
            playSound(audioStart);
        }

        // Inicializa o canvas e desenha a tela de início no carregamento
        window.onload = () => {
            resizeCanvas(); 
            draw();
        };
        
    </script>
    
    <br><footer>© Lucas Coelho, 2025</footer>
</body>
</html>
